/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.0/userguide/java_library_plugin.html
 */

plugins {
    id 'java-library'
}

repositories {
    mavenCentral()
    maven {
        url 'http://artifactory.contentserv.com/artifactory/rest'
    }
}

dependencies {

    compile project(path: ':pxp-rdbms-interface')
    compile project(path: ':pxp-technical-services')
    compile project(path: ':IElastic')

    compile group: 'org.elasticsearch', name: 'elasticsearch', version: '7.6.1'
	compile 'org.elasticsearch.client:elasticsearch-rest-client:7.6.1'
    compile 'org.elasticsearch.client:elasticsearch-rest-high-level-client:7.6.1'
}


import groovy.json.JsonSlurper
import groovy.json.JsonOutput

task clearElastic {
    doLast {
		print "=============ELASTIC DATA CLEARED============="
        def body = []
        def req = new URL('http://localhost:9200/_all').openConnection()
        req.setRequestMethod("DELETE")
        req.setRequestProperty("Content-Type", "application/json; charset=UTF-8")
        req.setDoOutput(true)
        req.getOutputStream().write(JsonOutput.toJson(body).getBytes("UTF-8"))
        logger.quiet "Status code: ${req.getResponseCode()}" 
        def resp = new JsonSlurper().parseText(req.getInputStream().getText())
        logger.quiet "Is Deleted: ${resp}"
    }
}